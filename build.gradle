/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.5/samples
 */

plugins {
    id 'base'
}

println "NOTE: project is configured"

tasks.register("A", {
    println "NOTE: task 'A' is configured"
    doLast {
        println "NOTE: task 'A' run"
    }
})

tasks.register("B") {
    finalizedBy "D"
    println "NOTE: task 'B' is configured"
    doLast {
        println "NOTE: task 'B' run"
    }
}

tasks.register("C") {
    dependsOn "A"
    finalizedBy "D"
    println "NOTE: task 'C' is configured"
    doLast {
        println "NOTE: task 'C' is run"
    }
}

tasks.register("D") {
    println "NOTE: task 'D' is configured"
    doLast {
        println "NOTE: task 'D' is run"
    }
}

// A mistake...

tasks.register('deleteBuild', Delete) {
    delete 'build'
}

tasks.register('createBuildResource', Copy) {
    from 'someResourceFile.txt'
    into 'build/resources'
}

tasks.register('configuresBasedOnBuildResource', Copy) {
    if (file('build/resources').exists()) {
        configureBasedOnBuildResource()
    } else {
        println "No resources dir, we can't configure based on it!"
    }
}

private configureBasedOnBuildResource() {
    fileTree('build/resources').visit {
        println "Let's say we configure something with $it"
    }
}

allprojects {
    tasks.register('forAll') {
        doLast {
            println "Task of project $project.name"
        }
    }
}